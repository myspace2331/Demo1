Exp9: To Understand Continuous monitoring and Installation and configuration of Nagios Core, Nagios Plugins and NRPE (Nagios Remote Plugin Executor) on Linux Machine.
Steps:
1.First requirement is to install Apache and PHP first. Use the following commands to complete it And use commands to install required packages for Nagios.
sudo apt-get update
sudo apt-get install wget build-essential unzip openssl libssl-dev
sudo apt-get install apache2 php libapache2-mod-php php-gd libgd-dev

2.Create a new user account for Nagios in your system and assign a password.
sudo adduser nagios

3.Now create a group for Nagios setup “nagcmd” and add nagios user to this group. Also, add nagios user in the Apache group
sudo groupadd nagcmd
sudo usermod -a -G nagcmd nagios
sudo usermod -a -G nagcmd www-data

4.Install Nagios Core Service
cd /opt/
sudo wget https://assets.nagios.com/downloads/nagioscore/releases/nagios-4.4.3.tar.gz
sudo tar xzf nagios-4.4.3.tar.gz
cd nagios-4.4.3
sudo ./configure –with-command-group=nagcmd
sudo make all
sudo make install
sudo make install-init
sudo make install-daemoninit
sudo make install-config
sudo make install-commandmode
sudo make install-exfoliation
sudo cp -R contrib/eventhandlers/ /usr/local/nagios/libexec/ sudo
chown -R nagios:nagios /usr/local/nagios/libexec/eventhandlers

5.Setup Apache with Authentication
Now create an Apache configuration file for your Nagios server as below:
sudo nano /etc/apache2/conf-available/nagios.conf
Add below lines to nagios.conf file.
ScriptAlias /nagios/cgi-bin "/usr/local/nagios/sbin"
<Directory "/usr/local/nagios/sbin">
 Options ExecCGI
 AllowOverride None
 Order allow,deny
 Allow from all
 AuthName "Restricted Area"
 AuthType Basic
 AuthUserFile /usr/local/nagios/etc/htpasswd.users
 Require valid-user
</Directory>
Alias /nagios "/usr/local/nagios/share"
<Directory "/usr/local/nagios/share">
 Options None
 AllowOverride None
 Order allow,deny
 Allow from all
 AuthName "Restricted Area"
 AuthType Basic
 AuthUserFile /usr/local/nagios/etc/htpasswd.users
 Require valid-user
</Directory>
To setup apache authentication for user nagiosadmin 
sudo htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin

6.Enable Apache configuration and restart Apache service to make the new settings take effect.cd
sudo a2enconf nagios
sudo a2enmod cgi rewrite
sudo service apache2 restart

7.Installing Nagios Plugins
cd /opt
sudo wget http://www.nagios-plugins.org/download/nagios-plugins-2.2.1.tar.gz
sudo tar xzf nagios-plugins-2.2.1.tar.gznagios
sudo tar xzf /opt/nagios-plugins-2.2.1.tar.gz -C /opt
cd nagios-plugins-2.2.1

8.Now compile and install Nagios plugins
sudo ./configure --with-nagios-user=nagios --with-nagios-group=nagios --with-openssl
sudo make 
sudo make install

8.Verify Settings
/usr/local/nagios/bin/nagios -v /usr/local/nagios/etc/nagios.cfg
sudo service nagios start
systemctl status nagios

9.Access Nagios Web Interface
Access your nagios setup by access nagios server using hostname or ip address followed by /nagios. http://127.0.0.1/nagios/
Prompting for Apache Authentication Password –
username: nagiosadmin
Password : which you enter while configuration














